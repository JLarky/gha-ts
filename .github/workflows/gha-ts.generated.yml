# Do not modify!
# This file was generated by https://github.com/JLarky/gha-ts

name: Test gha-ts
"on": 
  push: 
    {}
jobs: 
  formatTest: 
    name: Format Test
    runs-on: ubuntu-latest
    steps: 
      - name: checkout
        uses: actions/checkout@v5
      - name: Install mise
        uses: jdx/mise-action@v3
      - name: Bun install
        run: bun install
      - name: Format Check
        run: mise run format:check
  miseTest: 
    name: Mise Test
    runs-on: ubuntu-latest
    steps: 
      - name: checkout
        uses: actions/checkout@v5
      - name: Install mise
        uses: jdx/mise-action@v3
      - name: Bun install
        run: bun install
      - name: Test gha-ts
        run: mise run test
  dryRunPublish: 
    name: Dry run publish package
    runs-on: ubuntu-latest
    steps: 
      - name: checkout
        uses: actions/checkout@v5
      - name: Install mise
        uses: jdx/mise-action@v3
      - name: Dry run publish package
        run: bunx jsr publish --dry-run
  tryPublishedPackage: 
    name: Try Published Package
    runs-on: ubuntu-latest
    steps: 
      - name: checkout
        uses: actions/checkout@v5
      - name: Install mise
        uses: jdx/mise-action@v3
      - name: Run the test
        run: mise run validate-published-package
  checkGhaTsWorkflowsConverted: 
    name: Check gha-ts workflows converted
    runs-on: ubuntu-latest
    steps: 
      - name: checkout
        uses: actions/checkout@v5
      - name: Install mise
        uses: jdx/mise-action@v3
      - name: Install dependencies
        run: mise run install
      - name: Clear generated workflows
        run: mise run workflows:clear
      - name: Generate TS workflows to yaml
        run: mise run workflows:build
      - name: Verify if TS workflows are converted
        run: "CHANGED=\"$(git --no-pager diff --name-only)\";\n            if [ -n \"$CHANGED\" ]; then\n              echo \"::error title=TS workflows are not up to date::Run 'mise run workflows:build' locally, commit, and push.\";\n              echo \"::group::Changed files\";\n              echo \"$CHANGED\";\n              echo \"::endgroup::\";\n              while IFS= read -r file; do\n                [ -z \"$file\" ] && continue;\n                echo \"::notice file=$file,line=1,title=Changed file::Update generated YAML for this file\";\n              done <<< \"$CHANGED\";\n              {\n                echo \"### TS workflows are not up to date\";\n                echo;\n                echo \"Run: mise run workflows:build\";\n                echo;\n                echo \"Then commit the updated files and push.\";\n                echo;\n                echo \"Changed files:\";\n                echo;\n                echo \"$CHANGED\" | sed 's/^/- /';\n              } >> \"$GITHUB_STEP_SUMMARY\";\n              exit 1;\n            fi"
